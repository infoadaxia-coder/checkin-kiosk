<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宿泊者名簿登録 / Guest Registration</title>
    <style>
        body { font-family: sans-serif; background-color: #f0ebf8; margin: 0; padding: 20px; color: #202124; }
        .form-container { max-width: 640px; margin: 0 auto; }
        .header-card { background: white; border-top: 8px solid #673ab7; border-radius: 8px; padding: 24px; margin-bottom: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .question-card { background: white; border-radius: 8px; padding: 24px; margin-bottom: 12px; border: 1px solid #dadce0; }
        .label { font-weight: bold; display: block; margin-bottom: 8px; font-size: 16px; }
        .description { font-size: 13px; color: #5f6368; margin-bottom: 15px; white-space: pre-wrap; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="date"], textarea { 
            width: 100%; padding: 10px; border: none; border-bottom: 1px solid #dadce0; font-size: 16px; box-sizing: border-box; outline: none; background: #fafafa;
        }
        input:focus { border-bottom: 2px solid #673ab7; background: #fff; }
        .radio-group { margin-top: 10px; }
        .radio-item { margin-bottom: 10px; display: flex; align-items: center; }
        .radio-item input { margin-right: 10px; }
        .submit-btn { background-color: #673ab7; color: white; padding: 12px 30px; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; font-weight: bold; width: 100%; }
        .required { color: #d93025; }
        .terms-box { height: 150px; overflow-y: scroll; border: 1px solid #dadce0; padding: 15px; font-size: 12px; background: #fff; margin-bottom: 10px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="header-card">
            <h1>宿泊者名簿への登録</h1>
            <p>Registration Form (Inns and Hotels Act)</p>
        </div>

        <form id="mainForm">
            <div class="question-card">
                <span class="label">利用規約およびペット同伴規約への同意 <span class="required">*</span></span>
                <div class="terms-box">（ここに宿泊約款・ペット規約を貼り付け）</div>
                <label><input type="checkbox" id="agree" required> 同意します / I agree</label>
            </div>

            <div class="question-card">
                <span class="label">ペットの滞在有無／Will you be staying with a pet? <span class="required">*</span></span>
                <div class="radio-group">
                    <label class="radio-item"><input type="radio" name="pet" value="はい(Yes)" required> はい（Yes, I will be staying with a pet）</label>
                    <label class="radio-item"><input type="radio" name="pet" value="いいえ(No)"> いいえ（No, I will not be staying with a pet）</label>
                </div>
            </div>

            <div class="question-card">
                <label class="label">宿泊者氏名(全員)／Guest's name(All guests) <span class="required">*</span></label>
                <p class="description">宿泊者全員の名前を改行して入力してください。 / Please enter the names of all guests, each on a new line.</p>
                <textarea id="guestNames" required rows="4" placeholder="1. 山田太郎（35）, 2. 山田花子 (32)..."></textarea>
            </div>

            <div class="question-card">
                <label class="label">宿泊者住所（代表者の住所を記入）／ Guest Address <span class="required">*</span></label>
                <textarea id="address" required rows="2"></textarea>
            </div>

            <div class="question-card">
                <label class="label">電話番号／ Phone Number <span class="required">*</span></label>
                <input type="tel" id="tel" required>
            </div>

            <div class="question-card">
                <label class="label">メールアドレス／Email Address <span class="required">*</span></label>
                <input type="email" id="email" required>
            </div>

            <div class="question-card">
                <span class="label">性別／Gender <span class="required">*</span></span>
                <div class="radio-group">
                    <label class="radio-item"><input type="radio" name="gender" value="男性" required> 男性／Male</label>
                    <label class="radio-item"><input type="radio" name="gender" value="女性"> 女性／Female</label>
                    <label class="radio-item"><input type="radio" name="gender" value="その他"> その他／Other</label>
                </div>
            </div>

            <div class="question-card">
                <label class="label">年齢／Age <span class="required">*</span></label>
                <input type="text" id="age" required>
            </div>

            <div class="question-card">
                <label class="label">前泊地／Stayed Last night <span class="required">*</span></label>
                <input type="text" id="prevStay" required>
            </div>
            <div class="question-card">
                <label class="label">行先地／Destination <span class="required">*</span></label>
                <input type="text" id="nextStay" required>
            </div>

            <div class="question-card">
                <label class="label">チェックイン日／Check-in Date <span class="required">*</span></label>
                <input type="date" id="checkinDate" required>
            </div>
            <div class="question-card">
                <label class="label">チェックアウト日／Check-out Date <span class="required">*</span></label>
                <input type="date" id="checkoutDate" required>
            </div>

            <div class="question-card">
                <label class="label">身分証明書／Passport pictures (日本国籍の方は不要です)</label>
                <input type="file" id="fileInput" accept="image/*">
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">送信して完了 / Submit</button>
        </form>
    </div>

    <script>
        const gasUrl = "★ここにGASのURLを貼り付け★";
        const redirectUrl = "https://infoadaxia-coder.github.io/checkin-kiosk/thanks.html";

        document.getElementById('mainForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerText = "送信中 / Sending...";

            const file = document.getElementById('fileInput').files[0];
            let fileData = null;
            if (file) {
                fileData = await new Promise(resolve => {
                    const reader = new FileReader();
                    reader.onload = e => resolve(e.target.result);
                    reader.readAsDataURL(file);
                });
            }

            const payload = {
                pet: document.querySelector('input[name="pet"]:checked').value,
                names: document.getElementById('guestNames').value,
                address: document.getElementById('address').value,
                tel: document.getElementById('tel').value,
                email: document.getElementById('email').value,
                gender: document.querySelector('input[name="gender"]:checked').value,
                age: document.getElementById('age').value,
                prev: document.getElementById('prevStay').value,
                next: document.getElementById('nextStay').value,
                checkin: document.getElementById('checkinDate').value,
                checkout: document.getElementById('checkoutDate').value,
                fileData: fileData,
                fileName: file ? file.name : ""
            };

            try {
                const response = await fetch(gasUrl, { method: "POST", body: JSON.stringify(payload) });
                const result = await response.json();
                if (result.result === "success") window.location.href = redirectUrl;
            } catch (e) {
                alert("送信エラー。再試行してください。");
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
